<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ëêå„Åà„Å£Â®ò„ÇÇ„Çì„Åô„Åü„ÅÅ TOEIC „ÉÄ„É≥„Ç∏„Éß„É≥</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Noto+Sans+JP:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div id="game-container">
        <!-- Title Screen -->
        <div id="title-screen" class="screen active">
            <h1 class="game-title">Ëêå„Åà„Å£Â®ò„ÇÇ„Çì„Åô„Åü„ÅÅ<br>TOEIC „ÉÄ„É≥„Ç∏„Éß„É≥</h1>
            <div class="menu">
                <button class="menu-btn pixel-btn" id="mode-training-btn">ËÇ≤Êàê„É¢„Éº„Éâ (Training)</button>
                <button class="menu-btn pixel-btn" id="mode-gym-btn">„Ç∏„É†„Éê„Éà„É´ (Gym Battle)</button>
                <div style="height: 20px;"></div>
                <button class="menu-btn pixel-btn sm" id="continue-btn" style="display:none;">„ÉÄ„É≥„Ç∏„Éß„É≥ÂÜçÈñã</button>
            </div>
        </div>

        <!-- Starter Selection (Training Mode) -->
        <div id="starter-screen" class="screen">
            <h2 class="screen-title">„Éë„Éº„Éà„Éä„Éº„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑ</h2>
            <div class="starter-container">
                <!-- Bulbasaur -->
                <div class="starter-card" data-id="1">
                    <canvas class="starter-sprite-canvas" width="96" height="96" data-id="1"></canvas>
                    <div class="starter-info">
                        <h3>„Éï„Ç∑„ÇÆ„ÉÄ„Éç</h3>
                        <div class="type-badges"><span class="badge grass">Grass</span><span
                                class="badge poison">Poison</span></div>
                    </div>
                </div>
                <!-- Charmander -->
                <div class="starter-card" data-id="4">
                    <canvas class="starter-sprite-canvas" width="96" height="96" data-id="4"></canvas>
                    <div class="starter-info">
                        <h3>„Éí„Éà„Ç´„Ç≤</h3>
                        <div class="type-badges"><span class="badge fire">Fire</span></div>
                    </div>
                </div>
                <!-- Squirtle -->
                <div class="starter-card" data-id="7">
                    <canvas class="starter-sprite-canvas" width="96" height="96" data-id="7"></canvas>
                    <div class="starter-info">
                        <h3>„Çº„Éã„Ç¨„É°</h3>
                        <div class="type-badges"><span class="badge water">Water</span></div>
                    </div>
                </div>
            </div>
            <button class="pixel-btn back-btn" onclick="game.showScreen('title-screen')">Êàª„Çã</button>
        </div>

        <!-- Box / Party Selection (Gym Mode) -->
        <div id="party-select-screen" class="screen">
            <h2 class="screen-title">„Éë„Éº„ÉÜ„Ç£Á∑®Êàê</h2>
            <div class="party-layout">
                <div class="box-section">
                    <h3>Box (Storage)</h3>
                    <div id="box-grid" class="box-grid">
                        <!-- 16 slots generated by JS -->
                    </div>
                </div>
                <div class="party-section">
                    <h3>Party (Max 3)</h3>
                    <div id="party-list" class="party-list">
                        <!-- Selected pokemon -->
                    </div>
                    <button id="start-gym-run-btn" class="pixel-btn action-btn">„Ç∏„É†Âà∂Ë¶á„Å∏Âêë„Åã„ÅÜ</button>
                </div>
            </div>
            <button class="pixel-btn back-btn" onclick="game.showScreen('title-screen')">Êàª„Çã</button>
        </div>

        <!-- Gym Leader Progress Screen -->
        <div id="gym-progress-screen" class="screen">
            <h2 class="screen-title">„Ç∏„É†„É™„Éº„ÉÄ„ÉºÊåëÊà¶</h2>
            <div class="gym-leaders-grid">
                <!-- Row 1 -->
                <div class="gym-leader-card" data-leader-id="153">
                    <canvas class="leader-sprite" width="128" height="128"></canvas>
                    <div class="leader-name">„Çø„Ç±„Ç∑</div>
                    <div class="leader-badge">ü™® „Ç∞„É¨„Éº„Éê„ÉÉ„Ç∏</div>
                    <div class="leader-status">NEXT</div>
                </div>
                <div class="gym-leader-card" data-leader-id="154">
                    <canvas class="leader-sprite" width="128" height="128"></canvas>
                    <div class="leader-name">„Ç´„Çπ„Éü</div>
                    <div class="leader-badge">üíß „Éñ„É´„Éº„Éê„ÉÉ„Ç∏</div>
                    <div class="leader-status"></div>
                </div>
                <div class="gym-leader-card" data-leader-id="155">
                    <canvas class="leader-sprite" width="128" height="128"></canvas>
                    <div class="leader-name">„Éû„ÉÅ„Çπ</div>
                    <div class="leader-badge">‚ö° „Ç™„É¨„É≥„Ç∏„Éê„ÉÉ„Ç∏</div>
                    <div class="leader-status"></div>
                </div>
                <div class="gym-leader-card" data-leader-id="156">
                    <canvas class="leader-sprite" width="128" height="128"></canvas>
                    <div class="leader-name">„Ç®„É™„Ç´</div>
                    <div class="leader-badge">üåø „É¨„Ç§„É≥„Éú„Éº„Éê„ÉÉ„Ç∏</div>
                    <div class="leader-status"></div>
                </div>
                <!-- Row 2 -->
                <div class="gym-leader-card" data-leader-id="157">
                    <canvas class="leader-sprite" width="128" height="128"></canvas>
                    <div class="leader-name">„Ç≠„Éß„Ç¶</div>
                    <div class="leader-badge">üíú „Éî„É≥„ÇØ„Éê„ÉÉ„Ç∏</div>
                    <div class="leader-status"></div>
                </div>
                <div class="gym-leader-card" data-leader-id="158">
                    <canvas class="leader-sprite" width="128" height="128"></canvas>
                    <div class="leader-name">„Éä„ÉÑ„É°</div>
                    <div class="leader-badge">üîÆ „Ç¥„Éº„É´„Éâ„Éê„ÉÉ„Ç∏</div>
                    <div class="leader-status"></div>
                </div>
                <div class="gym-leader-card" data-leader-id="159">
                    <canvas class="leader-sprite" width="128" height="128"></canvas>
                    <div class="leader-name">„Ç´„ÉÑ„É©</div>
                    <div class="leader-badge">üî• „ÇØ„É™„É†„Çæ„É≥„Éê„ÉÉ„Ç∏</div>
                    <div class="leader-status"></div>
                </div>
                <div class="gym-leader-card" data-leader-id="160">
                    <canvas class="leader-sprite" width="128" height="128"></canvas>
                    <div class="leader-name">„Çµ„Ç´„Ç≠</div>
                    <div class="leader-badge">üåç „Ç∞„É™„Éº„É≥„Éê„ÉÉ„Ç∏</div>
                    <div class="leader-status"></div>
                </div>
            </div>
            <button id="start-next-gym-btn" class="pixel-btn action-btn">Ê¨°„ÅÆ„Ç∏„É†„É™„Éº„ÉÄ„Éº„Å´ÊåëÊà¶</button>
            <button class="pixel-btn back-btn" onclick="game.showScreen('title-screen')">„Çø„Ç§„Éà„É´„Å∏Êàª„Çã</button>
        </div>

        <!-- Dungeon Screen -->
        <div id="dungeon-screen" class="screen">
            <div class="status-bar">
                <div class="player-status" style="position:relative;">
                    <canvas id="dungeon-status-canvas" width="48" height="48" class="mini-sprite"
                        style="background:transparent;"></canvas>
                    <div class="bars">
                        <span id="player-name">Name</span> Lv.<span id="player-level">5</span>
                        <div class="hp-bar-sm">
                            <div id="d-hp-fill" class="fill"></div>
                        </div>
                        <span id="player-hp-text" style="font-size:10px;">20/20</span>
                    </div>
                </div>
                <button onclick="game.openSwitchMenu()" class="pad-btn"
                    style="width:auto; height:auto; padding:8px 12px; font-size:11px; margin-left:4px;">‚áÑ ‰∏¶„Å≥Êõø„Åà</button>
                <button onclick="game.usePotionInDungeon()" class="pad-btn"
                    style="width:auto; height:auto; padding:8px 12px; font-size:11px; margin-left:2px;">üíä ÂÇ∑Ëñ¨‰ΩøÁî®</button>
                <div class="inventory-display" style="font-size:12px; color:#aaa; display:flex; gap:10px;">
                    <span>üíä <span id="d-potion-count">0/5</span></span>
                    <span>üî¥ <span id="d-ball-count">0/5</span></span>
                </div>
                <div class="floor-info">
                    <span id="floor-display">1/9F</span>
                </div>
            </div>

            <canvas id="dungeon-canvas" width="600" height="400"></canvas>

            <div class="message-log" id="dungeon-message"></div>

            <div class="controls-pad">
                <button id="btn-up" class="pad-btn">‚ñ≤</button>
                <div class="row">
                    <button id="btn-left" class="pad-btn">‚óÄ</button>
                    <button id="btn-down" class="pad-btn">‚ñº</button>
                    <button id="btn-right" class="pad-btn">‚ñ∂</button>
                </div>
            </div>
        </div>

        <!-- Battle Screen -->
        <div id="battle-screen" class="screen">
            <div class="battle-scene">
                <!-- Enemy -->
                <div class="enemy-area">
                    <div class="stat-box">
                        <div class="name-row"><span id="enemy-name">Enemy</span> Lv.<span id="enemy-level">5</span>
                        </div>
                        <div class="hp-bar">
                            <div id="enemy-hp-fill" class="fill"></div>
                        </div>
                    </div>
                    <div class="sprite-area">
                        <canvas id="enemy-sprite" width="128" height="128"></canvas>
                    </div>
                </div>

                <!-- Player -->
                <div class="player-area">
                    <div class="sprite-area">
                        <canvas id="player-sprite" width="128" height="128"></canvas>
                    </div>
                    <div class="stat-box">
                        <div class="name-row"><span id="battle-player-name">Player</span> Lv.<span
                                id="battle-player-level">5</span></div>
                        <div class="hp-bar">
                            <div id="player-hp-fill" class="fill"></div>
                        </div>
                        <div class="hp-text"><span id="player-hp-val">20</span>/<span id="player-max-hp-val">20</span>
                        </div>
                        <div class="exp-bar">
                            <div id="player-exp-fill" class="fill"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- UI Panel -->
            <div class="battle-ui">
                <div class="ui-top-row">
                    <div id="message-box" class="message-box">
                        A wild Pokemon appeared!
                    </div>
                    <div class="command-box" style="gap: 4px;">
                        <div style="display:flex; gap:4px; flex:1;">
                            <button id="btn-potion" class="cmd-btn"
                                style="flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center; font-size:10px; line-height:1.2;">
                                <span style="font-size:18px;">üíä</span>
                                <span id="lbl-potion">ÂÇ∑Ëñ¨</span>
                            </button>
                            <button id="btn-ball" class="cmd-btn"
                                style="flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center; font-size:10px; line-height:1.2;">
                                <span style="font-size:18px;">üî¥</span>
                                <span id="lbl-ball">„Éú„Éº„É´</span>
                            </button>
                        </div>
                        <button id="btn-run" class="cmd-btn" style="height:30px;">ÈÄÉ„Åí„Çã</button>
                    </div>
                </div>

                <div id="action-menu" class="action-menu">
                    <div id="question-area" class="question-area" style="display:none;">
                        <p id="question-text">Question?</p>
                        <div id="choices-grid" class="choices-grid">
                            <!-- Buttons -->
                        </div>
                    </div>
                    <div id="move-area" class="move-area" style="display:none;">
                        <!-- 4 Move Buttons -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Dialogue Overlay (Gym Mode) -->
        <div id="dialogue-overlay" class="overlay" style="display:none;">
            <div class="dialogue-box">
                <div class="speaker-name" id="dialogue-speaker">Gym Leader</div>
                <div class="dialogue-text" id="dialogue-text">
                    Select your pokemon...
                </div>
                <div class="dialogue-next">‚ñº</div>
            </div>
        </div>

        <!-- Result Screen -->
        <div id="result-screen" class="screen">
            <h2 id="result-title">Victory!</h2>
            <div id="result-content"></div>
            <button class="pixel-btn" onclick="game.returnToTitle()">„Çø„Ç§„Éà„É´„Å∏</button>
        </div>

        <!-- Switch Overlay -->
        <div id="switch-overlay" class="overlay" style="display:none; align-items:center;">
            <div class="dialogue-box" style="height:auto; min-height:200px;">
                <div class="speaker-name" style="background:#444;">Pok√©mon Switch</div>
                <div id="switch-list"
                    style="display:flex; flex-direction:column; gap:5px; margin-top:20px; max-height:200px; overflow-y:auto;">
                    <!-- Items -->
                </div>
                <button class="pixel-btn" style="margin-top:10px;"
                    onclick="document.getElementById('switch-overlay').style.display='none'">Èñâ„Åò„Çã</button>
            </div>
        </div>
    </div>

    <!-- Hidden Assets -->
    <img id="sprite-sheet" src="poke.png" style="display:none;">
    <img id="tiles-sheet" src="map_tiles.png" style="display:none;">

    <!-- Scripts -->
    <script src="pokemon.js"></script>
    <script src="toeic-questions.js"></script>
    <script src="save-manager.js"></script>
    <script src="sprite-loader.js"></script>
    <script src="dungeon.js"></script>
    <script src="battle.js"></script>
    <script src="game.js"></script>
</body>

</html>